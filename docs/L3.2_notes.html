<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jelena H. Pantel" />


<title>Week 8, Lecture 3.2 Notes</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecological Modelling</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Syllabus
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./schedule.html">Course schedule</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    About me
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./aboutme.html">Learn more about me</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Project 1</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./project1.html">Guidelines</a>
        </li>
        <li>
          <a href="./Pantel_cheat_LV.html">Example cheat sheet</a>
        </li>
        <li class="dropdown-submenu">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Resources</a>
          <ul class="dropdown-menu" role="menu">
            <li>
              <a href="./stage.html">Stage structured models</a>
            </li>
            <li>
              <a href="./metapop.html">Metapopulation model</a>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li>
      <a href="./project2.html">Project 2</a>
    </li>
  </ul>
</li>
<li>
  <a href="./contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/githubusername/mywebsite">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Week 8, Lecture 3.2 Notes</h1>
<h4 class="author">Jelena H. Pantel</h4>
<h4 class="date">2022-12-01 08:54:01</h4>

</div>


<div id="notes" class="section level2">
<h2>Notes</h2>
<p>Note 1. This will be the reading guide for Lehaye et al. 1994.</p>
</div>
<div id="discussion-questions" class="section level2">
<h2>Discussion questions</h2>
<ol style="list-style-type: decimal">
<li>What is the overall goal of this analysis and study - what critical
question are the researchers addressing that makes the study, data, and
models useful?</li>
</ol>
<p>This is a study of fragmented owl populations in California (United
States). After studying the demographics of the largest population, they
then analyze metapopulation dynamics in the system. They “modelled the
system to assess…the demographic characteristics that most strongly
influence the dynamics and its risk of decline under a set of
alternative assumptions.” [page 776, end of Introduction] So they are
trying to understand what factors might place the owl population more at
risk for extinction.</p>
<ol start="2" style="list-style-type: decimal">
<li>Owls can fly, which in theory means in a landscape you can find them
anywhere. <img src="media/landscape1.jpg" style="width:25.0%"
alt="Landscape is continuous" /> Yet, the researchers apply
<em>metapopulation</em> theory, which assumes the species occupies a
patchy landscape. <img src="media/landscape2.jpg" style="width:25.0%"
alt="Landscape is patchy" /> Why is owl habitat patchy and not
continuous?</li>
</ol>
<p>Due to the nature of the owls’ habitat, which is forest trees that
exist between 800-2600m elevation. Their habitat is thus patchy across
the mountains in southern California that have this forest habitat.
[page 776, Study Area, San Bernadino Mountains]</p>
<ol start="3" style="list-style-type: decimal">
<li>What is the estimated carrying capacity of the San Bernadino (SBM)
and San Jacinto (SJM) mountain spotted owl population? (hint: see Figure
1)</li>
</ol>
<p>SBM - 266, SJM - 40</p>
<p>4a. The researchers estimated a population growth rate <em>r</em> =
0.86 for the SBM population- please find where in the text this result
is given.</p>
<p>page 779, Results, Parameter estimation, 2nd paragraph</p>
<p>4b. The researchers used an initial abundance for their simulations
of 70% of carrying capacity - given this, what is the <span
class="math inline">\(N_0\)</span> (this is one common way to write
“initial population size”, pronounced “N nought”, which is British
English for “zero” and has the same pronunciation as “N not”) of the SBM
population?</p>
<p><span class="math inline">\(N_0 = 0.7(266) = 186.2\)</span></p>
<p>4c. Use this <em>r</em> value and the <em>K</em> values given in
Figure 2 to develop a simulation of population dynamics for SBM spotted
owls. Use your <span class="math inline">\(N_0\)</span> value above as
the first <span class="math inline">\(N_t\)</span> value. Plot the
results of population size (<em>N</em>) over time.
<strong>Hint</strong>: Use the example code in Lecture 2.3 notes.**
<strong>Hint</strong>: Here is what my plot looks like
<strong>Hint</strong>: Use formula 3.5a from <a
href="./r3_OttoDay_Ch3.pdf"><strong>Otto &amp; Day Chapter
3</strong></a>. (You can run the simulation for 20 time steps)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1. Parameters</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.86</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">266</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Nt <span class="ot">&lt;-</span> .<span class="dv">7</span><span class="sc">*</span>K</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2. Equation function</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>discrete_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(r,K,Nt){</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  Nt1 <span class="ot">&lt;-</span> Nt <span class="sc">+</span> r<span class="sc">*</span>Nt<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> Nt<span class="sc">/</span>K)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Nt1)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3. Make sure the function works</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>Nt1 <span class="ot">&lt;-</span> <span class="fu">discrete_logistic</span>(r,K,Nt)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4. Create a new variable to hold future values of N</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">20</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5. Create a for loop to iteratively calculate N</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>N[<span class="dv">1</span>] <span class="ot">&lt;-</span> Nt</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  N[i] <span class="ot">&lt;-</span> <span class="fu">discrete_logistic</span>(r,K,Nt)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  Nt <span class="ot">&lt;-</span> N[i]</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="L3.2_notes_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li>The researchers estimated population growth rate <em>R</em> using
data collected from the SBM population, fit to a <em>two-stage Leslie
projection matrix</em> model. This is a model for
<em>stage-structured</em> populations, as is the case for the spotted
owl. We begin from the discrete-time model for exponential population
growth:</li>
</ol>
<p><span class="math display">\[N_{t+1} = RN_t\]</span></p>
<p>Where <em>N</em> is abundance and <em>R</em> is the population growth
rate. The matrix population growth equation looks similar:</p>
<p><span class="math display">\[\boldsymbol{N_{t+1}} =
\boldsymbol{A}\boldsymbol{N_t}\]</span> Where <strong>N</strong> is a
<strong>vector</strong> of abundances (the abundances for all stages),
and <strong>A</strong> is the <strong>transition matrix</strong>:</p>
<p><span class="math display">\[\begin{bmatrix} N_1\\
N_2 \\
\end{bmatrix}_{t+1} = \begin{bmatrix}F_1 &amp; F_2\\
P_{1 \to 2} &amp; P_{2 \to 2}\\
\end{bmatrix} \cdot \begin{bmatrix}N_1\\
N_2\\
\end{bmatrix}_t\]</span></p>
<p>Where, <span class="math inline">\(F_1\)</span> and <span
class="math inline">\(F_2\)</span> are the <em>fecundities</em> of stage
1 and stage 2 (per-capita production of offspring by stage 1 and 2
individuals) and <span class="math inline">\(P_{1 \to 2}\)</span> and
<span class="math inline">\(P_{2 \to 2}\)</span> are the
<em>survivorship</em> - Stage 1 can survice by transitioning to Stage 2,
and <span class="math inline">\(P_{1 \to 2}\)</span> is the probability
of this transition. Stage 2 can survive by staying in the same stage,
and <span class="math inline">\(P_{2 \to 2}\)</span> is the probability
of this happening.</p>
<p>Let’s use R to simulate the population growth of the SBM
population.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1. Build the transition matrix A</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>P<span class="fl">.12</span> <span class="ot">&lt;-</span> <span class="fl">0.344</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>P<span class="fl">.22</span> <span class="ot">&lt;-</span> <span class="fl">0.767</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>F1 <span class="ot">&lt;-</span> <span class="fl">0.304</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>F2 <span class="ot">&lt;-</span> <span class="fl">0.304</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Nt <span class="ot">&lt;-</span> .<span class="dv">7</span><span class="sc">*</span>K</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    F1, F2,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    P<span class="fl">.12</span>, P<span class="fl">.22</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow=</span>T)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] 0.304 0.304
## [2,] 0.344 0.767</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2. Build the matrix Nt (initial abundance matrix)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Nt <span class="ot">&lt;-</span> <span class="fu">c</span>((Nt<span class="sc">/</span><span class="dv">2</span>),(Nt<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3. Matrix multiplication for Nt+1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>Year1 <span class="ot">&lt;-</span> A <span class="sc">%*%</span> Nt  <span class="co"># matrix multiplication!</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>Year1</span></code></pre></div>
<pre><code>##          [,1]
## [1,]  56.6048
## [2,] 103.4341</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4. Create a new variable to hold future values of N</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="at">dim=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">2</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5. Create a for loop to iteratively calculate N</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>N[<span class="dv">1</span>,] <span class="ot">&lt;-</span> Nt</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  N[i,] <span class="ot">&lt;-</span> A <span class="sc">%*%</span> N[i<span class="dv">-1</span>,]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="L3.2_notes_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Your turn: Add a hypothetical 3rd stage to the model, with:</p>
<p><span class="math display">\[\begin{bmatrix} N_1\\
N_2 \\
N_3 \\
\end{bmatrix}_{t+1} = \begin{bmatrix}F_1 &amp; F_2 &amp; F_3\\
P_{1 \to 2} &amp; P_{2 \to 2} &amp; P_{3 \to 2}\\
P_{1 \to 3} &amp; P_{2 \to 3} &amp; P_{3 \to 3}\\
\end{bmatrix} \cdot \begin{bmatrix}N_1\\
N_2\\
N_3\\
\end{bmatrix}_t\]</span> In this model, continue to use the same values
as above for <span class="math inline">\(F_1\)</span>, <span
class="math inline">\(F_2\)</span>, <span class="math inline">\(P_{1 \to
2}\)</span>, and <span class="math inline">\(P_{2 \to 2}\)</span>. Set
<span class="math inline">\(P_{3 \to 2}\)</span> = 0 (because the owls
can’t go back a stage) and <span class="math inline">\(P_{1 \to
3}\)</span> = 0 (because the owls can’t skip a stage). Set <span
class="math inline">\(P_{2 \to 3}\)</span> = 0.1, <span
class="math inline">\(P_{3 \to 3}\)</span> = 0.1, and <span
class="math inline">\(F_3\)</span> = 0.304.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1. Build the transition matrix A</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>P<span class="fl">.12</span> <span class="ot">&lt;-</span> <span class="fl">0.344</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>P<span class="fl">.22</span> <span class="ot">&lt;-</span> <span class="fl">0.767</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>F1 <span class="ot">&lt;-</span> <span class="fl">0.304</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>F2 <span class="ot">&lt;-</span> <span class="fl">0.304</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>Nt <span class="ot">&lt;-</span> .<span class="dv">7</span><span class="sc">*</span>K</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>P<span class="fl">.32</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>P<span class="fl">.13</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>P<span class="fl">.23</span> <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>P<span class="fl">.33</span> <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>F3 <span class="ot">&lt;-</span> <span class="fl">0.304</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    F1, F2, F3,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    P<span class="fl">.12</span>, P<span class="fl">.22</span>, P<span class="fl">.32</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    P<span class="fl">.13</span>, P<span class="fl">.23</span>, P<span class="fl">.33</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">byrow=</span>T)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#A</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2. Build the matrix Nt (initial abundance matrix)</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>Nt <span class="ot">&lt;-</span> <span class="fu">c</span>((Nt<span class="sc">/</span><span class="dv">3</span>),(Nt<span class="sc">/</span><span class="dv">3</span>),(Nt<span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3. Matrix multiplication for Nt+1</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>Year1 <span class="ot">&lt;-</span> A <span class="sc">%*%</span> Nt  <span class="co"># matrix multiplication!</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Year1</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4. Create a new variable to hold future values of N</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="at">dim=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">3</span>))</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5. Create a for loop to iteratively calculate N</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>N[<span class="dv">1</span>,] <span class="ot">&lt;-</span> Nt</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  N[i,] <span class="ot">&lt;-</span> A <span class="sc">%*%</span> N[i<span class="dv">-1</span>,]</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6. Plot N over time</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(N[,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;N&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">300</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(N[,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;N&quot;</span>,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(N[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(N[,<span class="dv">2</span>],<span class="at">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;N&quot;</span>,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(N[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(N[,<span class="dv">3</span>],<span class="at">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;N&quot;</span>,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;skyblue&quot;</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Stage 1&quot;</span>,<span class="st">&quot;Stage 2&quot;</span>,<span class="st">&quot;Stage 3&quot;</span>))</span></code></pre></div>
<p><img src="L3.2_notes_files/figure-html/unnamed-chunk-6-1.png" width="672" />
6. Can you explain why increased correlation in sensitivity to
environmental variation among spotted owl populations can place the
entire metapopulation at increased risk of extinction (1st paragraph on
page 778)?</p>
<p>As the authors state, if each population growth rate <em>r</em>
responds to varying rainfall in an independent way, then populations
that have fluctuating low <em>r</em> might become extinct but the
remainder of the populations would not be affected. “It would be less
likely that all populations would go extinct at the same time compared
to a case where the fluctuations were dependent.” Traditional
metapopulation models might underestimate extinction risk of they do not
take this potential correlation into account.</p>
<ol start="7" style="list-style-type: decimal">
<li>Can you explain why the formula on page 778:</li>
</ol>
<p><span class="math display">\[ N_i(t+1) = N_i(t)R_i(t) -
\sum_{j=1}^{n} m_{ij}N_i + \sum_{i=1}^{n} m_{ji}N_j\]</span></p>
<p>represents a metapopulation model? Please include a definition for
metapopulation, with a citation (using <a
href="https://scholar.google.com">Google Scholar</a> (perhaps <a
href="./media/Hanski_Gilpin_1991.pdf">Hanski &amp; Gilpin 1991</a>).</p>
<p>A metapopulation is a term to describe “a population of populations”,
or populations with dynamics that are linked via their connection and
the possibility of re-colonization after extinction from other patches
(Hanski &amp; Gilpin 1991). The formula above is a metapopulation model
simply because the population size of patch <em>i</em> <span
class="math inline">\(N_{it}\)</span> depends on the population size and
migration to / from other patches.</p>
<p>Hanski, I., &amp; Gilpin, M. (1991). Metapopulation dynamics: brief
history and conceptual domain. Biological journal of the Linnean
Society, 42(1-2), 3-16.</p>
<ol start="8" style="list-style-type: decimal">
<li>The authors believe there is evidence that (i) population locations
are correlated in the amount of total annual rainfall and (ii) that this
environmental property impacts fecundity. Please explain their analysis
to justify this.</li>
</ol>
<ol style="list-style-type: lower-roman">
<li><p>They analyzed the correlation between rainfall among patches
(Table 2) and found that this depended on among-site distance (Figure
2).</p></li>
<li><p>They tested for and observed a relationship between rainfall and
fecundity (number of young per pair, Figure 5).</p></li>
</ol>
<ol start="9" style="list-style-type: decimal">
<li>Please look carefully at Figure 9 - what is on the x- and y-axis?
How do they support this statement: a correlation in response of
populations to rainfall makes spotted owls <em>more likely</em> to
become extinct.</li>
</ol>
<p>The x-axis is . The y-axis is .</p>
<ol start="10" style="list-style-type: decimal">
<li>Compare Figure 9 to Figure 8 - is metapopulation structure important
to understand Spotted owl extinction risk?</li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
