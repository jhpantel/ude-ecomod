<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jelena H. Pantel" />


<title>Module 4.1 Exercise</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.2.1/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.2.1/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecological Modelling</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Syllabus
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./schedule.html">Course schedule</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    About me
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./aboutme.html">Learn more about me</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Project 1</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./project1.html">Guidelines</a>
        </li>
        <li>
          <a href="./media/ugly_logistic_cheat_sheet.pdf">Example cheat sheet</a>
        </li>
        <li class="dropdown-submenu">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Resources</a>
          <ul class="dropdown-menu" role="menu">
            <li>
              <a href="./LV_comp.html">Lotka Volterra models (pred-prey, competition)</a>
            </li>
            <li>
              <a href="./stage.html">Stage structured models</a>
            </li>
            <li>
              <a href="./metapop.html">Metapopulation model</a>
            </li>
            <li>
              <a href="./equi_stab.html">Equilibrium and stability analysis</a>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li>
      <a href="./project2.pdf">Project 2</a>
    </li>
  </ul>
</li>
<li>
  <a href="./contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/githubusername/mywebsite">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Module 4.1 Exercise</h1>
<h4 class="author">Jelena H. Pantel</h4>
<h4 class="date">2023-11-23 17:58:19</h4>

</div>


<div id="exercise-1.-fitting-data-to-a-model-linear-regression"
class="section level2">
<h2>Exercise 1. Fitting data to a model: linear regression</h2>
<div id="a.-overview" class="section level5">
<h5>A. Overview</h5>
<p>I indicated that even a linear regression is actually proposing a
model - that a response variable <em>y</em> is driven by a driving
variable <em>x</em>, and that this relationship is linear. For example,
I might hypothesize that newborn baby weight (kg) is driven by the
length of gestation (weeks). As a researcher, I collect data to test
this hypothesize and see how well a linear model does describe the
relationship, and I estimate the <em>parameters</em> in the linear
model.</p>
<p>The data looks like this:</p>
<table>
<thead>
<tr class="header">
<th align="left">gestation</th>
<th align="left">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">30</td>
<td align="left">1.6</td>
</tr>
<tr class="even">
<td align="left">32</td>
<td align="left">1.7</td>
</tr>
<tr class="odd">
<td align="left">34</td>
<td align="left">2.5</td>
</tr>
<tr class="even">
<td align="left">36</td>
<td align="left">2.8</td>
</tr>
<tr class="odd">
<td align="left">38</td>
<td align="left">3.2</td>
</tr>
<tr class="even">
<td align="left">40</td>
<td align="left">3.5</td>
</tr>
</tbody>
</table>
<p>The linear model looks like this:</p>
<p><span class="math display">\[y = m(x) + b\]</span> <span
class="math display">\[ weight = m(gestation period) + b \]</span> This
model has variables <em>y</em> and <em>x</em>, and parameters <em>m</em>
(the slope) and <em>b</em> (the <em>y</em>-intercept). Our goal is to
<strong>fit the data to the model</strong>, and estimate the model
parameters <em>m</em> and <em>b</em> that are most consistent with the
data. You will learn how to do this in an Introduction to Statistics
with R class - here I am using it to show you how to fit data to a model
in the most basic case. This knowledge will come in handy later when we
have more complex data and models. Please open a new R script and
complete the following exercises (in some instances I provide the full
code and you just need to type it into your R script. In other instances
you will generate the code during class). Save your code
periodically!</p>
</div>
<div id="step-1-enter-the-data-into-r" class="section level5">
<h5>Step 1: Enter the data into R</h5>
<p>To enter the data into R, just paste this code in:</p>
<pre class="r"><code>baby &lt;- matrix(data = cbind(c(30, 32, 34, 36, 38, 40), c(1.6,
    1.7, 2.5, 2.8, 3.2, 3.5)), nrow = 6, ncol = 2, dimnames = list(NULL,
    c(&quot;gestation&quot;, &quot;weight&quot;)))
baby &lt;- as.data.frame(baby)</code></pre>
</div>
<div
id="step-2-create-a-plot-with-gestation-period-on-the-x-axis-and-weight-on-the-y-axis"
class="section level5">
<h5>Step 2: Create a plot with gestation period on the x-axis and weight
on the y-axis</h5>
<p>Please create a scatterplot with gestation period on the x-axis and
weight on the y-axis. Add in informative x and y-axis labels. Mine is
below.</p>
<p><img src="E4.1_files/figure-html/unnamed-chunk-3-1.png" width="50%" /></p>
</div>
<div
id="step-3-use-least-squares-regression-to-fit-data-to-linear-model-estimate-the-most-likely-parameter-values-given-the-data"
class="section level5">
<h5>Step 3: Use least-squares regression to fit data to linear model,
estimate the most likely parameter values given the data</h5>
<p>Paste the code I provide here, to fit the data to the linear model
and estimate the values for <span class="math inline">\(b\)</span> (the
y-intercept) and <span class="math inline">\(m\)</span> (the slope of
the linear relationship).</p>
<pre class="r"><code># Fit linear model
model = lm(weight ~ gestation, data = baby)
# Examine model
summary(model)</code></pre>
<p>Based on this, what are the most likely estimates for the slope and
y-intercept?</p>
<p>And what is the value of the residual sum of squares (RSS, sum of
squared deviations from observed to model-predicted data)?</p>
<pre class="r"><code>deviance(model)</code></pre>
<pre><code>## [1] 0.09371429</code></pre>
<p>We can place the model-estimated line onto the scatterplot of the
observed data to see the model-predicted values of weight for each
gestation age <em>according to our model</em>. We use the command
<code>abline(model)</code>:</p>
<pre class="r"><code>plot(baby, main = &quot;Estimated baby weights during pregnancy&quot;,
    xlab = &quot;Gestation period (weeks)&quot;, ylab = &quot;Weight (kg)&quot;)
abline(model)</code></pre>
<p><img src="E4.1_files/figure-html/unnamed-chunk-7-1.png" width="50%" /></p>
</div>
<div
id="step-4-repeat-use-least-squares-regression-to-fit-data-to-linear-model-estimate-the-most-likely-parameter-values-given-the-data"
class="section level5">
<h5>Step 4: Repeat: use least-squares regression to fit data to linear
model, estimate the most likely parameter values given the data</h5>
<p>To make sure this is clear, let’s look at the sum of squared
residuals for some data that is poor fit to a linear model. Enter the
following data into R, and run a linear regression using the
<code>lm</code> command, then calculate the <em>residual sum of squares
(RSS)</em>:</p>
<table>
<thead>
<tr class="header">
<th align="center">gestation</th>
<th align="center">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">30</td>
<td align="center">1.4</td>
</tr>
<tr class="even">
<td align="center">32</td>
<td align="center">2.4</td>
</tr>
<tr class="odd">
<td align="center">34</td>
<td align="center">2.4</td>
</tr>
<tr class="even">
<td align="center">36</td>
<td align="center">4.7</td>
</tr>
<tr class="odd">
<td align="center">38</td>
<td align="center">3.8</td>
</tr>
<tr class="even">
<td align="center">40</td>
<td align="center">3.2</td>
</tr>
</tbody>
</table>
<p><img src="E4.1_files/figure-html/unnamed-chunk-9-1.png" width="50%" /></p>
<p>I got a value of sum of squared residuals equal to 3.4161905,
indicating that the best-fit line (obtained by minimizing the RSS) is
not as good a fit to this data as the dataset above.</p>
<p>I hope it makes sense now how we fit data to our hypothesized model
and estimate the parameters of the model most likely to have produced
our observed data.</p>
</div>
</div>
<div
id="exercise-2.-fitting-data-to-a-model-nonlinear-least-squares-nls"
class="section level2">
<h2>Exercise 2. Fitting data to a model: nonlinear least squares
(nls)</h2>
<div id="a.-overview-1" class="section level5">
<h5>A. Overview</h5>
<p>We can use the same perspective - fitting data to a model by
minimizing the RSS - to study non-linear models. This presentation is
very straight-forward, but I will be transparent that non-linear least
squares isn’t always easy (I chose data that was relatively easy to
fit). You would take more coursework to really be ready to apply this to
more nonlinear models (thought it certainly is done, usually for
single-species growth or feeding curves).</p>
<p>Here, we will look at how organisms absorb and utilize nutrients - a
nutrient-response curve (perhaps useful for studying phtyoplankton
nutrient uptake). In this instance, we still have a response variable
<em>y</em> and a causal variable <em>x</em>, but the relationship
between <em>x</em> and <em>y</em> is nonlinear. It has been observed
that many nutrient-response curves reach an asymptote, where organisms
become saturated, and no longer increase their absorption no matter how
many more nutrients are available. The shape of one kind of useful
saturation curve is described by a <em>Michaelis-Menten</em> model.</p>
<p>The general form of this is:</p>
<p><span class="math display">\[ Y = \frac{aX}{b + X} \]</span></p>
<p>In our phytoplankon example, let’s say that <em>Y</em> is the cell
length (in <span class="math inline">\(\mu m\)</span>) and <em>X</em> is
the phosphorus concentration (in <span class="math inline">\(\mu g /
l\)</span>). The model parameters are <em>a</em>, the upper asymptote
(for <span class="math display">\[ X \to \infty \]</span>), and
<em>b</em>, the the <em>X</em> value giving a response equal to
<em>a</em>/2.</p>
<p>The data looks like this:</p>
<table>
<thead>
<tr class="header">
<th align="right">Y</th>
<th align="right">X</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">12.73644</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">13.66411</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="right">14.10844</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">14.43210</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">14.77975</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">14.86073</td>
<td align="right">39</td>
</tr>
<tr class="odd">
<td align="right">14.78124</td>
<td align="right">46</td>
</tr>
<tr class="even">
<td align="right">14.90793</td>
<td align="right">200</td>
</tr>
</tbody>
</table>
<p><img src="E4.1_files/figure-html/unnamed-chunk-10-1.png" width="40%" /></p>
</div>
<div
id="step-2-use-nonlinear-least-squares-to-fit-data-to-model-estimate-the-most-likely-parameter-values-given-the-data"
class="section level5">
<h5>Step 2: Use nonlinear least-squares to fit data to model, estimate
the most likely parameter values given the data</h5>
<p>Non-linear least squares is included in base R and can be fit to data
using the <code>nls</code> command. Use <code>?nls</code> to check the
syntax needed to get this command to work: You’ll need to specify the
model formula, the data, and often starting values - these are beginning
options for estimates for the nls estimator. nls has a difficult job,
which is guessing the combination of parameters that are the best fit
for the data - give it a hand by making reasonable suggestions for
beginning values of model parameters that need to ne estimated.</p>
<p>Note that r is also pre-supplied with <em>some</em> model formulas,
including a Michaelis-Menten curve, that pre-chooses starting values for
you. If you’re lucky eough to be fitting a model already included in R’s
formulas, the job will be easier. You can find the self-starting models
included with R by checking <code>?selfStart</code>, these include:
<code>SSasymp, SSasympOff, SSasympOrig, SSbiexp, SSfol, SSfpl, SSgompertz, SSlogis, SSmicmen, SSweibull</code>.</p>
<p>To fit the data to the Michaelis-Menten model using the self-start
formula <code>SSmicmen</code>:</p>
<pre class="r"><code>model.nls &lt;- nls(Y ~ SSmicmen(X, a, b))
summary(model.nls)</code></pre>
<p><strong>Question: What are the most likely estimates for the
parameters in the model, <span class="math inline">\(a\)</span> and
<span class="math inline">\(b\)</span></strong></p>
<p>Let’s plot the data and fitted curve:</p>
<pre class="r"><code>newX &lt;- as.data.frame(seq(0, 200, by = 0.1))
colnames(newX) &lt;- &quot;X&quot;
pred &lt;- predict(model.nls, newX)
plot(X, Y, main = &quot;Michaelis-Menten nutrient uptake&quot;, xlab = &quot;cell length (micrometers)&quot;,
    ylab = &quot;P (micrograms / liter)&quot;)
lines(newX$X, pred, lwd = 3, col = &quot;blue&quot;)</code></pre>
<p><img src="E4.1_files/figure-html/unnamed-chunk-12-1.png" width="50%" /></p>
</div>
<div
id="step-3-use-nls-to-analyze-data-for-2-competing-daphnia-over-9-weeks-in-a-mesocosm"
class="section level5">
<h5>Step 3: Use nls to analyze data for 2 competing <em>Daphnia</em>
over 9 weeks in a mesocosm</h5>
<p>I set up an experiment in 2020, where I placed <em>Daphnia pulex</em>
and <em>Daphnia magna</em> in a 300-liter container, added water,
nutrients, and phytoplankton. I let the <em>Daphnia</em> grow for 8
weeks, then fit the data to a Lotka-Volterra competition model, to
estimate growth rates and interaction coefficients. I used nls for this,
so let’s take a look at the data and the fit of that curve.</p>
<p>For this, I will use a modified, discrete-time version of the
Lotka-Volterra competition equation:</p>
<p><span class="math display">\[\begin{aligned}
n_{1,t+1} &amp;= n_{1,t} + n_{1,t}(L_1 e^{(-A_1 n_{1,t} - B_1 n_{2,t})})
\\
n_{2,t+1} &amp;= n_{2,t} + n_{2,t}(L_2 e^{(-A_2 n_{2,t} - B_2 n_{1,t})})
\end{aligned}\]</span></p>
<p>Here, the model parameters are:</p>
<ul>
<li><p><span class="math inline">\(L_1\)</span> and <span
class="math inline">\(L_2\)</span> - the population growth rate</p></li>
<li><p><span class="math inline">\(A_1\)</span> and <span
class="math inline">\(A_2\)</span> - the rate of intraspecific
competition (competition with individuals of the same species)</p></li>
<li><p><span class="math inline">\(B_1\)</span> and <span
class="math inline">\(B_2\)</span> - the rate of interspecific
competition (competition with individuals of the other species)</p></li>
</ul>
<p><strong>Please make a scatterplot of the data for the 2 species, with
time (week) on the x-axis and points for the two species on the
y-axis</strong></p>
<p>I include my code here in case you just want to use mine:</p>
<pre class="r"><code>dp &lt;- matrix(data = cbind(1:8, c(44, 1082, 5681, 6036, 3310,
    2900, 1504, 340), c(44, 401, 6684, 10652, 6308, 5198, 3872,
    2417)), nrow = 8, ncol = 3, dimnames = list(NULL, c(&quot;week&quot;,
    &quot;dp&quot;, &quot;dm&quot;)))
dp &lt;- as.data.frame(dp)
knitr::kable(dp, format = &quot;markdown&quot;, padding = -1L, align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">week</th>
<th align="center">dp</th>
<th align="center">dm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">44</td>
<td align="center">44</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1082</td>
<td align="center">401</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">5681</td>
<td align="center">6684</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">6036</td>
<td align="center">10652</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">3310</td>
<td align="center">6308</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">2900</td>
<td align="center">5198</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">1504</td>
<td align="center">3872</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="center">340</td>
<td align="center">2417</td>
</tr>
</tbody>
</table>
<pre class="r"><code>plot(dp$week, dp$dm, pch = 19, col = &quot;orange&quot;, main = &quot;Daphnia population size&quot;,
    xlab = &quot;week&quot;, ylab = &quot;N&quot;)
points(dp$week, dp$dp, pch = 19, col = &quot;black&quot;)
legend(&quot;topright&quot;, legend = c(&quot;D. magna&quot;, &quot;D. pulex&quot;), pch = 19,
    col = c(&quot;orange&quot;, &quot;black&quot;))</code></pre>
<p><img src="E4.1_files/figure-html/unnamed-chunk-13-1.png" width="50%" /></p>
<p>Here is code to get the nls model to fit, and estimate parameters in
the Lotka-Volterra competition equation.</p>
<pre class="r"><code>sub &lt;- read.csv(&quot;https://raw.githubusercontent.com/jhpantel/ude-ecomod/main/data/sub.csv&quot;,
    header = T)

dp_mod &lt;- nls(dp_Nt1 ~ dp_Nt + dp_Nt * ((L * exp(-A * dp_Nt -
    B * dm_Nt))^days), data = sub, start = c(L = 1.5, A = 1e-04,
    B = 1e-04), na.action = na.omit)</code></pre>
<p>The code seen here estimates the value of <span
class="math inline">\(L_1\)</span>, <span
class="math inline">\(A_1\)</span>, and <span
class="math inline">\(B_1\)</span> - all parameters for the D. pulex
growth equation. <strong>What are the model-estimated values for those
parameters, given the data?</strong> Hint: use
<code>summary(dp_mod)</code></p>
<pre class="r"><code>sub$yhat &lt;- predict(dp_mod)
plot(sub$week[sub$meso == 30], sub$dp_Nt1[sub$meso == 30], main = &quot;mesocosm 30 D. pulex&quot;,
    xlab = &quot;week&quot;, ylab = &quot;N&quot;, pch = 19, col = &quot;orange&quot;)
lines(sub$week[sub$meso == 30], sub$yhat[sub$meso == 30], col = &quot;blue&quot;)</code></pre>
<p><img src="E4.1_files/figure-html/unnamed-chunk-15-1.png" width="40%" /></p>
<p>Finally, please edit the code to fit the model for the D. magna data.
Give the most likely parameter estimates, and a plot of the data and
model-fit line.</p>
</div>
</div>
<div
id="exercise-3.-fitting-data-to-lotka-volterra-competition-model-using-gauser"
class="section level2">
<h2>Exercise 3. Fitting data to Lotka-Volterra competition model using
gauseR</h2>
<div id="a.-overview-2" class="section level5">
<h5>A. Overview</h5>
<p>We will use data from Gause’s experiments with Paramecium, tracking
competitive interactions between <em>P. aurelia</em> and <em>P.
caudatum</em>.</p>
<pre class="r"><code># load competition data
data(&quot;gause_1934_science_f02_03&quot;)

# subset out data from species grown in mixture
mixturedat &lt;- gause_1934_science_f02_03[gause_1934_science_f02_03$Treatment ==
    &quot;Mixture&quot;, ]

# extract time and species data
time &lt;- mixturedat$Day
species &lt;- data.frame(mixturedat$Volume_Species1, mixturedat$Volume_Species2)
colnames(species) &lt;- c(&quot;P_caudatum&quot;, &quot;P_aurelia&quot;)

# run wrapper
gause_out &lt;- gauseR::gause_wrapper(time = time, species = species)</code></pre>
<p><img src="E4.1_files/figure-html/unnamed-chunk-17-1.png" width="40%" /></p>
<p>What were the parameter estimates?</p>
<pre class="r"><code>gause_out$parameter_intervals</code></pre>
<pre><code>##                lower_sd           mu      upper_sd
## P_caudatum0  0.01033120  1.595268713  2.463299e+02
## P_aurelia0   0.08812049  1.631618399  3.021066e+01
## r1           0.34795148  1.259232133  4.557146e+00
## r2           0.47571115  1.026156214  2.213521e+00
## a11         -0.02061163 -0.005157869 -1.290709e-03
## a12         -0.02361279 -0.008000167 -2.710508e-03
## a21         -0.01100428 -0.001974871 -3.544183e-04
## a22         -0.01459709 -0.006851130 -3.215572e-03</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
